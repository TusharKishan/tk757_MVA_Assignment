---
title: "MVA_Visualization"
author: "pronak@business.rutgers.edu"
date: "2/3/2023"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

```{r}
library(readr)
sparrows <- read_csv("/Users/ronakpar/Desktop/Rutgers/MVA/R Exercise/K25945 - R code and data sets/Chapter 1/Bumpus_sparrows.csv")
str(sparrows)
boxplot(sparrows[,2:6])
stars(sparrows,labels = sparrows$Survivorship)

butterflies <- read_csv("/Users/ronakpar/Desktop/Rutgers/MVA/R Exercise/K25945 - R code and data sets/Chapter 1/Butterfly colonies.csv")
str(butterflies)
boxplot(butterflies[,2:11])
stars(butterflies,labels=butterflies$Colony)

skulls <- read_csv("/Users/ronakpar/Desktop/Rutgers/MVA/R Exercise/K25945 - R code and data sets/Chapter 1/Egyptian skulls.csv")
str(skulls)
boxplot(skulls[,2:5])
stars(skulls)

euroemp <- read_csv("/Users/ronakpar/Desktop/Rutgers/MVA/R Exercise/K25945 - R code and data sets/Chapter 1/Euroemp.csv")
str(euroemp)
boxplot(euroemp[,3:11])
stars(euroemp,labels=euroemp$Country)

dogs <- read_csv("/Users/ronakpar/Desktop/Rutgers/MVA/R Exercise/K25945 - R code and data sets/Chapter 1/Prehistoric dogs.csv")
str(dogs)
boxplot(dogs[,2:7])
stars(dogs,labels=dogs$Group)

# Dive Deeper into Visualization Techniques

attach(sparrows)

#Plots
sparr.birds <- data.frame(as.numeric(rownames(sparrows)),sparrows[,2:6])
labs.diagonal <- c("Bird","Total length","Alar extent","L. beak & head","L. humerous","L. keel & sternum")

plot(Total_length, Alar_extent,xlab="Total Length (mm)",ylab="Alar extent (nm)",pch=c(16,1))

# Correlations
pairs(sparrows[,2:6])

# A Different View on Correlation Matrix
library(SciViews)
pairs(sparr.birds, diag.panel = panel.boxplot, labels=labs.diagonal,pch=c(1,16),font.labels=2)

# 3 Dimensional Plots
library(scatterplot3d)
s3d <- scatterplot3d(Alar_extent,Total_length,L_beak_head,pch=c(1,16)[as.numeric(Survivorship)],xlab="Alar extent", ylab="", angle=45,zlab="Length of beak and head", lty.hide=2,type="h",y.margin.add=0.1,font.axis=2,font.lab=2)
legend(s3d$xyz.convert(238, 160, 34.1),c("Non-survivor","Survivor"),pch=c(1,16),text.font=2)

# Scatter Plot Matrix
library(car)
scatterplotMatrix(~Total_length+Alar_extent+L_beak_head+L_humerous+L_keel_sternum | Survivorship, data=sparr.birds, var.labels=labs.diagonal,cex.labels=0.7, diagonal="boxplot",smooth=FALSE,reg.line=FALSE,pch=c(1,16),col=rep("black",2), legend.plot=FALSE)


library(lattice)
super.sym <- trellis.par.get("superpose.symbol")
super.sym$superpose.symbol$pch <- c(1,16,rep(1,5))
super.sym$superpose.symbol$col <- rep("#000000",7)
trellis.par.set(super.sym)
splom(~sparr.birds, groups = Survivorship, data = sparr.birds, ps=0.5, varname.cex = .5,panel = panel.superpose,key = list(columns = 2,points = list(pch = super.sym$pch[1:2], col=super.sym$col[1:2]),text = list(c("Non-survivor", "Survivor"))))

library(GGally)
ggscatmat(sparrows, columns=2:6, color="Survivorship")
detach(sparrows)

# load packages
library(lattice)
library(ggplot2)
library(ggridges)
library(ggvis)
library(ggthemes)
library(cowplot)
library(gapminder)
library(gganimate)
library(dplyr)
library(tidyverse)
library(grid)
library(gridExtra)
library(RColorBrewer)

# Using Diamonds Data
data(diamonds)
attach(diamonds)

# base R
plot(price~carat)

plot(price~carat)
abline(lm(price~carat), col="red")

plot(price~carat, col="steelblue", pch=3, main="Diamond Data", xlab="weight of diamond in carats", 
     ylab="price of diamond in dollars", xlim=c(0,3))
xyplot(price~carat)
xyplot(price~carat | cut)
xyplot(price~carat, groups=cut)
xyplot(price~carat | cut + clarity)
xyplot(price~carat | cut , groups=clarity, auto.key=list(space="right"))

xyplot(price~carat, col="steelblue", pch=3, main="Diamond Data", xlab="weight of diamond in carats", 
       ylab="price of diamond in dollars", xlim=c(0,3), scales=list(tick.number=10))

# ggplot
ggplot(diamonds, aes(x=carat,y=price)) + geom_point()

ggplot(diamonds, aes(x=carat,y=price)) + facet_wrap(clarity) + geom_point()

ggplot(diamonds, aes(x=carat, y=price)) + geom_point(aes(color=cut))

ggplot(diamonds, aes(x=carat,y=price)) + xlim(0,3) + geom_point(colour="steelblue", pch=3) + 
  labs(x="weight of diamond in carats", y="price of diamond in dollars", title="Diamond Data") 

# bar chart
ggplot(diamonds, aes(cut)) + geom_bar(position="stack") 
ggplot(diamonds, aes(clarity) )+ geom_bar(position="stack") 
ggplot(diamonds, aes(clarity)) + facet_grid(.~cut) + geom_bar(position="dodge")

# histogram
ggplot(diamonds, aes(depth))+geom_histogram()
ggplot(diamonds, aes(depth))+geom_histogram(aes(fill = after_stat(count)))

# regression
ggplot(diamonds, aes(x=carat, y=price)) + geom_point() + geom_smooth(method=lm)
ggplot(diamonds, aes(x=carat, y=price)) + geom_point() + stat_smooth()
ggplot(mtcars, aes(x=mpg, y=disp)) + geom_point() + stat_smooth()
# we can also plot customized confidence interval bands, but this requires computing them separately [see ggplot2 help]

# violin plot 
ggplot(diamonds, aes(x=cut, y=price)) + geom_violin()
ggplot(diamonds, aes(x=clarity, y=price)) + geom_violin()
ggplot(diamonds, aes(x=color, y=price)) + geom_violin()

# box plot
ggplot(diamonds, aes(x=color, y=price)) + geom_boxplot()
ggplot(diamonds, aes(x=color, y=price)) + geom_boxplot() + coord_flip()

# density plot and ggridges
ggplot(diamonds, aes(x=carat)) + geom_density() 
ggplot(diamonds, aes(x=carat, fill=clarity, color=clarity)) + geom_density() 
ggplot(diamonds, aes(x=carat, fill=clarity, color=clarity)) + geom_density(alpha=0.3, aes(y=..scaled..)) 

ggplot(diamonds, aes(x=carat, y=clarity)) + geom_density_ridges() 
ggplot(diamonds, aes(x=price)) + geom_density() 
ggplot(diamonds, aes(x=price, y=clarity)) + geom_density_ridges() 

# hexbin
ggplot(diamonds, aes(x=carat, y=price)) + geom_hex() 

# with ggthemes (see also ggsci, ggthemr)
lastplot <- ggplot(diamonds, aes(x=carat,y=price)) + xlim(0,3) + geom_point(aes(color=cut)) + stat_smooth() + 
  labs(x="weight of diamond in carats", y="price of diamond in dollars", title="Diamond Data") 

lastplot + theme_bw()
lastplot + theme_cowplot()
lastplot + theme_dark()
lastplot + theme_economist()
lastplot + theme_fivethirtyeight()
lastplot + theme_tufte()
lastplot + theme_wsj()

# for more information see
# ggplot docs at https://ggplot2.tidyverse.org/
# ggplot extensions at https://exts.ggplot2.tidyverse.org/
# ggplot2 book (via link.springer.com)



```
